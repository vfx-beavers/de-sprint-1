## 1.1. Требования к целевой витрине.
	Присвойте каждому клиенту три значения — значение фактора Recency, значение фактора Frequency и значение фактора Monetary Value:
	- Фактор Recency измеряется по последнему заказу. Распределите клиентов по шкале от одного до пяти, где значение 1 получат те, кто либо вообще не делал заказов, либо делал их очень давно, а 5 — те, кто заказывал относительно недавно.
	- Фактор Frequency оценивается по количеству заказов. Распределите клиентов по шкале от одного до пяти, где значение 1 получат клиенты с наименьшим количеством заказов, а 5 — с наибольшим.
	- Фактор Monetary Value оценивается по потраченной сумме. Распределите клиентов по шкале от одного до пяти, где значение 1 получат клиенты с наименьшей суммой, а 5 — с наибольшей.

**Необходимые проверки и условия:**
- Проверьте, что количество клиентов в каждом сегменте одинаково. Например, если в базе всего 100 клиентов, то 20 клиентов должны получить значение 1, ещё 20 — значение 2 и т. д.
- Для анализа нужно отобрать только успешно выполненные заказы - заказ со статусом Closed.
- Просят при расчете витрины обращаться только к объектам из схемы analysis. Чтобы не дублировать данные (данные находятся в этой же базе), решаем создать view. Таким образом, View будут находиться в схеме analysis и вычитывать данные из схемы production. 

**Где хранятся данные:** в схеме production содержатся оперативные таблицы.

**Куда надо сохранить витрину:** витрина должна располагаться в той же базе в схеме analysis.

**Стуктура витрины:** витрина должна называться dm_rfm_segments и состоять из таких полей:
	- user_id
	- recency (число от 1 до 5)
	- frequency (число от 1 до 5)
	- monetary_value (число от 1 до 5)
**Глубина данных:** в витрине нужны данные с начала 2022 года.

**Обновления не нужны.**


## 1.2. Структура исходных данных.

Данные будут браться из схемы production, следующих таблиц и соответствующих столбцов:
- Таблица users. Используемые поля: id(тип int) - идентификатор пользователя.
- Таблица orderstatuses. Используемые поля: id(тип int) - идентификатор статуса заказа, key(тип varchar(255)) - значение ключа статуса.
- Таблица orders. Используемые поля: user_id(тип int) - идентификатор пользоавтеля, order_ts(тип timestamp) - дата и время заказа, payment(numeric(19,5)) - сумма оплаты по заказу.